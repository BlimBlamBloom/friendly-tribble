<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>第一章 第一章 - 马叉叉的房子</title>
/* === General Page Styles === */
<style>
  
body {
  font-family: Arial, sans-serif;
  line-height: 1.6;
  max-width: 800px;
  margin: 40px auto;
  padding: 0 20px;
  background-color: #fafafa;
  color: #333;
}

h1 {
  text-align: center;
  color: #0073e6;
  margin-bottom: 30px;
}

#chinese-text {
  white-space: pre-wrap;
  font-size: 1.25em;
  line-height: 2.2;
  margin-bottom: 30px;
  padding: 15px 20px;
  background-color: #ffffff;
  border: 1px solid #d1e3fc;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0, 115, 230, 0.1);
  font-family: "Noto Sans SC", "Microsoft Yahei", Arial, sans-serif;
  letter-spacing: 0.03em;
  text-indent: 2em;
}

#chinese-text p {
  margin-bottom: 1.5em;
}

#pinyin-text, #english-text {
  display: none;
  background: #eef6ff;
  border: 1px solid #b3d1ff;
  padding: 15px;
  margin: 10px 0 20px 0;
  white-space: pre-wrap;
  font-size: 1.1em;
}

button.toggle-btn {
  background-color: #0073e6;
  color: white;
  border: none;
  padding: 10px 18px;
  margin-right: 10px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 1em;
}

button.toggle-btn:hover {
  background-color: #005bb5;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  margin-top: 30px;
}

th, td {
  border: 1px solid #ccc;
  padding: 10px;
  text-align: left;
}

th {
  background-color: #e6f2ff;
  font-weight: bold;
}

tr:nth-child(even) {
  background-color: #f9f9f9;
}

footer {
  margin-top: 50px;
  text-align: center;
}

footer a {
  color: #0073e6;
  text-decoration: none;
  font-size: 1.1em;
}

footer a:hover {
  text-decoration: underline;
}

  /* === Matching Game Styles === */
  #game-container {
    display: flex;
    justify-content: center;
    gap: 40px;
    margin-top: 30px;
    flex-wrap: nowrap;
  }

  .column {
    display: flex;
    flex-direction: column;
    gap: 12px;
    flex: 1;
    min-width: 180px;
  }

  .card {
    padding: 14px 20px;
    background-color: #f0f8ff;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.2em;
    text-align: center;
    box-shadow: 3px 4px 8px rgba(0, 0, 0, 0.15);
    min-width: 160px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    transition: none; /* no hover scaling */
  }

  .selected {
    background-color: #b3e0ff !important;
    box-shadow: 0 0 10px #5fb8ff;
  }

  .card.matched {
    background-color: #ccc !important;
    color: #666;
    cursor: default;
    box-shadow: none;
  }

  .card.matched:hover {
    background-color: #ccc;
  }

  /* Timer and progress bar styling kept from your original if needed */
  #timer {
    font-size: 1.6em;
    font-weight: bold;
    text-align: center;
    margin-top: 20px;
    color: #228822; /* Green initially */
    transition: color 0.3s ease;
    user-select: none;
  }

  #timer.warning {
    color: #d15c5c; /* Red when low time */
  }

  #progress-bar-container {
    width: 100%;
    height: 16px;
    background-color: #e0e0e0;
    border-radius: 10px;
    margin: 10px auto 25px auto;
    max-width: 400px;
    overflow: hidden;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
  }

  #progress-bar {
    height: 100%;
    background-color: #4caf50;
    width: 100%;
    transition: width 1s linear;
  }

  /* Start button styling */
  #start-button {
    display: block;
    margin: 25px auto 0 auto;
    padding: 12px 25px;
    font-size: 1.25em;
    background-color: #0073e6;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 2px 3px 8px rgba(0,115,230,0.4);
    transition: background-color 0.3s ease;
    user-select: none;
  }

  #start-button:hover {
    background-color: #005bb5;
  }

</style>
</head>
<body>

<h1>第一章: 马叉叉的房子</h1>

<p><strong>收听第一章：</strong></p>
<iframe width="360" height="202"
        src="https://www.youtube.com/embed/FUiR9DOUybw"
        title="YouTube video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
</iframe>

<!-- Chinese text -->
<div id="chinese-text" style="white-space: pre-line;">
马叉叉有一个房子。房子不大，也不小。房子在南边，东边有一棵树，北边有一个火车站。
每天早上，马叉叉开车去火车站。不是因为他要去工作，而是因为他想看火车。他说：“世界不错，但是我很喜欢火车!”
马叉叉有一个朋友，是一只猫。猫不说话，但是喜欢听音乐。马叉叉下班以后，总是回家，跟猫一起听音乐，喝牛奶，吃方便面。他们在一起很开心。
晚上，马叉叉坐在电脑前，看见一本书。他说：“这是什么书？我还没看过这本书。”猫看了看书，叫了一声：“喵。”
</div>

<!-- Buttons -->
<div style="margin-top: 15px;">
  <button class="toggle-btn" onclick="toggleVisibility('pinyin-text')">拼音</button>
  <button class="toggle-btn" onclick="toggleVisibility('english-text')">英文</button>
</div>

<!-- Pinyin text -->
<div id="pinyin-text">
Mǎ Chāchā yǒu yí gè fángzi. Fángzi bú dà, yě bù xiǎo. Fángzi zài nánbian, dōngbian yǒu yì kē shù, běibian yǒu yí gè huǒchēzhàn.
Měitiān zǎoshang, Mǎ Chāchā kāichē qù huǒchēzhàn. Bú shì yīnwèi tā yào qù gōngzuò, ér shì yīnwèi tā xiǎng kàn huǒchē. Tā shuō: “Shìjiè búcuò, dànshì wǒ hěn xǐhuān huǒchē!”
Mǎ Chāchā yǒu yí gè péngyǒu, shì yì zhī māo. Māo bù shuōhuà, dànshì xǐhuān tīng yīnyuè. Mǎ Chāchā xiàbān yǐhòu, zǒngshì huíjiā, gēn māo yìqǐ tīng yīnyuè, hē niúnǎi, chī fāngbiànmiàn. Tāmen zài yìqǐ hěn kāixīn.
Wǎnshàng, Mǎ Chāchā zuò zài diànnǎo qián, kànjiàn yì běn shū. Tā shuō: “Zhè shì shénme shū? Wǒ hái méi kànguò zhè běn shū.” Māo kànle kàn shū, jiào le yì shēng: “Miāo.”
</div>

<!-- English text -->
<div id="english-text">
Ma Chacha has a house. The house is not big, not small. The house is in the south. To the east, there is a tree. To the north, there is a train station.
Every morning, Ma Chacha drives to the train station. It’s not because he’s going to work, but because he wants to watch the trains. He says, “The world is not bad, but I really like trains!”
Ma Chacha has a friend — a cat. The cat doesn’t talk, but it likes listening to music. After work, Ma Chacha always goes home to listen to music with the cat, drink milk, and eat instant noodles. They are very happy when together.
At night, Ma Chacha sits in front of his computer and sees a book. He says, “What kind of book is this? I haven’t seen this book before.” The cat looked at the book and meowed: “Meow.”
</div>

<!-- Vocabulary list -->
<h2>生词</h2>
<table>
  <thead>
    <tr>
      <th>汉字</th>
      <th>拼音</th>
      <th>意思</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>棵</td><td>kē</td><td>measure word for trees and plants</td></tr>
    <tr><td>每天</td><td>měitiān</td><td>every day</td></tr>
    <tr><td>叫</td><td>jiào</td><td>to call / to cry (animal sounds)</td></tr>
    <tr><td>安静</td><td>ānjìng</td><td>quiet / peaceful</td></tr>
    <tr><td>看见</td><td>kànjiàn</td><td>to see / catch sight of</td></tr>
    <tr><td>不是因为...而是...</td><td>bú shì yīn wèi... ér shì...</td><td>not because... but rather...</td></tr>
    <tr><td>不错</td><td>búcuò</td><td>not bad</td></tr>
    <tr><td>坐</td><td>zuò</td><td>to sit</td></tr>
    <tr><td>还没...过</td><td>hái méi ... guò</td><td>have not ... yet</td></tr>
    <tr><td>声</td><td>shēng</td><td>sound</td></tr>
    <tr><td>奇怪</td><td>qíguài</td><td>strange</td></tr>
    <tr><td>世界</td><td>shìjiè</td><td>world</td></tr>
  </tbody>
</table>

<!-- Start button -->
<button id="start-button">开始</button>

<!-- Timer display -->
<div id="timer-container" style="display:none;">
  Time left: <span id="timer">90</span>s
  <div id="progress-bar"><div id="progress-bar-fill"></div></div>
</div>

<!-- Matching Game -->
<div id="game-container" aria-live="polite" aria-label="Vocabulary matching game">
  <div class="column" id="left-column"></div>
  <div class="column" id="right-column"></div>
</div>

<p id="feedback"></p>
<div id="end-message" style="margin-top: 30px; text-align: center; font-size: 1.3em;"></div>

<script>
  // Toggle visibility for pinyin and english
  function toggleVisibility(id) {
    const el = document.getElementById(id);
    el.style.display = (el.style.display === 'block') ? 'none' : 'block';
  }

  const vocab = {
    "棵": ["measure word for trees and plants"],
    "每天": ["every day"],
    "叫": ["to call / to cry (animal sounds)"],
    "安静": ["quiet / peaceful"],
    "看见": ["to see / catch sight of"],
    "不是因为...而是...": ["not because... but rather..."],
    "不错": ["not bad"],
    "坐": ["to sit"],
    "还没...过": ["have not ... yet"],
    "声": ["sound"],
    "奇怪": ["strange"],
    "世界": ["world"]
  };

  let currentGameVocab = {};
  let selectedLeft = null;
  let selectedRight = null;
  let matched = 0;
  let timerInterval = null;
  let timeLeft = 90;
  let gameActive = false;

  function shuffleArray(arr) {
    return arr.sort(() => Math.random() - 0.5);
  }

  function createCards() {
    const leftColumn = document.getElementById('left-column');
    const rightColumn = document.getElementById('right-column');
    const feedback = document.getElementById('feedback');
    const endMessage = document.getElementById('end-message');

    leftColumn.innerHTML = '';
    rightColumn.innerHTML = '';
    feedback.textContent = '';
    endMessage.innerHTML = '';

    matched = 0;
    selectedLeft = null;
    selectedRight = null;

    // Choose 6 random entries from vocab
    const allEntries = Object.entries(vocab);
    const selectedEntries = shuffleArray(allEntries).slice(0, 6);

    const selectedVocab = {};
    selectedEntries.forEach(([word, defs]) => {
      selectedVocab[word] = defs[0];
    });

    currentGameVocab = selectedVocab;

    // Shuffle both sides independently
    const shuffledChinese = shuffleArray(Object.keys(selectedVocab));
    const shuffledEnglish = shuffleArray(Object.values(selectedVocab));

    shuffledChinese.forEach(word => {
      const card = document.createElement('div');
      card.className = 'card';
      card.textContent = word;
      card.onclick = () => handleLeftClick(card, word);
      leftColumn.appendChild(card);
    });

    shuffledEnglish.forEach(def => {
      const card = document.createElement('div');
      card.className = 'card';
      card.textContent = def;
      card.onclick = () => handleRightClick(card, def);
      rightColumn.appendChild(card);
    });
  }

  function clearSelections(side) {
    const cards = document.querySelectorAll(`#${side}-column .card`);
    cards.forEach(c => c.classList.remove('selected'));
  }

  function handleLeftClick(card, word) {
    if (!gameActive) return;
    if (card.classList.contains('matched')) return;
    clearSelections('left');
    selectedLeft = { card, word };
    card.classList.add('selected');
    checkMatch();
  }

  function handleRightClick(card, def) {
    if (!gameActive) return;
    if (card.classList.contains('matched')) return;
    clearSelections('right');
    selectedRight = { card, def };
    card.classList.add('selected');
    checkMatch();
  }

  function checkMatch() {
    if (selectedLeft && selectedRight) {
      const correctDef = currentGameVocab[selectedLeft.word];
      const feedback = document.getElementById('feedback');

      if (correctDef === selectedRight.def) {
        // Correct match
        selectedLeft.card.classList.add('matched');
        selectedRight.card.classList.add('matched');
        selectedLeft.card.onclick = null;
        selectedRight.card.onclick = null;
        feedback.textContent = '✅ 正确!';

        matched++;
        selectedLeft = null;
        selectedRight = null;

        if (matched === 6) {
          setTimeout(() => {
            createCards();
            feedback.textContent = '';
          }, 700);
        }
      } else {
        // Wrong match - reset immediately, no animation
        feedback.textContent = '❌ 再试一次!';
        selectedLeft.card.classList.remove('selected');
        selectedRight.card.classList.remove('selected');
        selectedLeft = null;
        selectedRight = null;
      }
    }
  }

  function startGame() {
    if (gameActive) return;
    gameActive = true;
    timeLeft = 90;
    document.getElementById('timer-container').style.display = 'block';
    document.getElementById('start-button').style.display = 'none';
    createCards();
    updateTimerDisplay();
    timerInterval = setInterval(() => {
      timeLeft--;
      updateTimerDisplay();
      if (timeLeft <= 0) {
        endGame();
      }
    }, 1000);
  }

  function updateTimerDisplay() {
    const timerSpan = document.getElementById('timer');
    const timerContainer = document.getElementById('timer-container');
    const progressBarFill = document.getElementById('progress-bar-fill');

    timerSpan.textContent = timeLeft;
    let percent = (timeLeft / 90) * 100;
    progressBarFill.style.width = percent + '%';

    if (timeLeft <= 15) {
      timerContainer.classList.add('low-time');
    } else {
      timerContainer.classList.remove('low-time');
    }
  }

  function endGame() {
    gameActive = false;
    clearInterval(timerInterval);
    document.getElementById('feedback').textContent = '';
    document.getElementById('timer-container').style.display = 'none';

    const endMessage = document.getElementById('end-message');
    endMessage.innerHTML = `
      <p>🎉 恭喜你！你在90秒内配对了 <strong>${matched}</strong> 个正确。</p>
      <button id="start-button-again">再来一次</button>
    `;

    // Disable all cards clicks
    document.querySelectorAll('.card').forEach(card => card.onclick = null);

    document.getElementById('start-button-again').onclick = () => {
      endMessage.innerHTML = '';
      document.getElementById('start-button').style.display = 'inline-block';
    };
  }

  // Set up start button event listener
  document.getElementById('start-button').addEventListener('click', startGame);
</script>



<footer>
  <a href="base-vocabulary.html">← 返回 生词</a> |
  <a href="chapter2.html">第二章 →</a> |
  <a href="/chinese/short-stories/ma-chacha.html">返回首页</a>
</footer>

</body>
</html>
